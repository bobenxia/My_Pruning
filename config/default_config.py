from yacs.config import CfgNode as CN

_C = CN()

# -----------------------------------------------------------------------------
# Misc
# -----------------------------------------------------------------------------
_C.GPUS = (0, 1, 2, 3, 4, 5, 6, 7)


# -----------------------------------------------------------------------------
# CUDNN
# -----------------------------------------------------------------------------
_C.CUDNN = CN()
_C.CUDNN.BENCHMARK = True
_C.CUDNN.DETERMINISTIC = False
_C.CUDNN.ENABLED = True


# -----------------------------------------------------------------------------
# Model
# -----------------------------------------------------------------------------
_C.MODEL = CN()
_C.MODEL.WEIGHTS = './outputs/checkpoint_normal.pth'
_C.MODEL.BN_MOMENTUM = 0.1


# -----------------------------------------------------------------------------
# DATASET
# -----------------------------------------------------------------------------
_C.DATASET = CN()
_C.DATASET.ROOT = "/data/xiazheng/"
_C.DATASET.TRAIN_SPLIT = 'train'
_C.DATASET.VALID_SPLIT = 'val'
_C.DATASET.CROP_SIZE = 224
_C.DATASET.RESIZE_SIZE = 224
_C.DATASET.MEAN = (0.485, 0.456, 0.406)
_C.DATASET.STD = (0.229, 0.224, 0.225)
_C.DATASET.HFLIP_PROB = 0.5
_C.DATASET.AURO_AUGMENT_POLICY = 'imagenet'


# -----------------------------------------------------------------------------
# DATALOADER
# -----------------------------------------------------------------------------
_C.DATALOADER = CN()

_C.DATALOADER.BATCH_SIZE = 128
_C.DATALOADER.NUM_WORKERS = 8


# -----------------------------------------------------------------------------
# TRAIN 主要用于 model_train.py
# -----------------------------------------------------------------------------
# -----------------------------------------------------------------------------
# TRAIN
# -----------------------------------------------------------------------------
_C.TRAIN = CN()

_C.TRAIN.SUMMARY_WRITER = "./outputs/checkpoint_normal.pth"
